{% extends "../meta/base.html" %}
{% block title %}Изучение: {{ set_title }} | FlipSpace{% endblock %}
{% block content %}
<div class="min-vh-100 d-flex flex-column" style="overflow-y: auto;">
    {% include "../meta/header.html" %}

    <!-- Основной контент -->
    <div class="container py-5 flex-grow-1">
        <!-- Заголовок набора -->
        <div class="text-center mb-4">
            <h1 class="display-5 fw-bold text-white mb-2">{{ set_title }}</h1>
            <p class="text-light opacity-75 mb-3">Изучайте карточки в своем темпе</p>
            <a href="/sets" class="btn btn-outline-light btn-sm">
                <i class="bi bi-arrow-left me-2"></i>К наборам
            </a>
        </div>

        <!-- Прогресс-бар -->
        <div class="mb-4" id="progress-container">
            <div class="glass-effect p-3 rounded-4">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-light fw-semibold">Прогресс изучения</span>
                    <span class="text-light" id="progress-text">Хорошо изучено: 0 / {{ cards|length }}</span>
                </div>
                <div class="progress" style="height: 10px; background: rgba(255, 255, 255, 0.1);">
                    <div class="progress-bar" role="progressbar" id="progress-bar"
                         style="width: 0%; background: linear-gradient(90deg, #34d399 0%, #10b981 100%);"
                         aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
        </div>

        <!-- Контейнер карточки -->
        <div class="row justify-content-center mb-4">
            <div class="col-lg-8 col-xl-6">
                <div id="card-container" class="flashcard-container">
                    <!-- Карточка -->
                    <div class="flashcard glass-effect p-5 rounded-4 text-center">
                        <div class="card-content">
                            <!-- Вопрос -->
                            <div id="question-container">
                                <h3 class="text-white mb-4">Вопрос</h3>
                                <p class="text-light fs-4 mb-4" id="question-text"></p>
                            </div>

                            <!-- Ответ (скрыт по умолчанию) -->
                            <div id="answer-container" style="display: none;">
                                <hr class="border-light opacity-25 my-4">
                                <h4 class="text-white-50 mb-3">Ответ</h4>
                                <p class="text-light fs-5" id="answer-text"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Кнопки управления -->
        <div class="row justify-content-center">
            <div class="col-lg-8 col-xl-6">
                <!-- Кнопка "Показать ответ" -->
                <div id="show-answer-btn-container" class="text-center">
                    <button class="btn btn-primary btn-lg px-5 btn-glow" id="show-answer-btn">
                        <i class="bi bi-eye me-2"></i>
                        Показать ответ
                    </button>
                    <div class="mt-3 text-light opacity-75">
                        <small><i class="bi bi-keyboard me-1"></i>Нажмите <kbd class="bg-light text-dark">Пробел</kbd></small>
                    </div>
                </div>

                <!-- Кнопки оценки (скрыты по умолчанию) -->
                <div id="rating-buttons-container" style="display: none;">
                    <div class="text-center mb-3">
                        <p class="text-light mb-3">Оцените, насколько хорошо вы знали ответ:</p>
                    </div>
                    <div class="d-flex flex-wrap justify-content-center gap-2">
                        <button class="btn btn-rating btn-rating-1" data-rating="1">
                            <span class="rating-number">1</span>
                            <span class="rating-label">Снова</span>
                        </button>
                        <button class="btn btn-rating btn-rating-2" data-rating="2">
                            <span class="rating-number">2</span>
                            <span class="rating-label">Трудно</span>
                        </button>
                        <button class="btn btn-rating btn-rating-3" data-rating="3">
                            <span class="rating-number">3</span>
                            <span class="rating-label">Нормально</span>
                        </button>
                        <button class="btn btn-rating btn-rating-4" data-rating="4">
                            <span class="rating-number">4</span>
                            <span class="rating-label">Хорошо</span>
                        </button>
                        <button class="btn btn-rating btn-rating-5" data-rating="5">
                            <span class="rating-number">5</span>
                            <span class="rating-label">Легко</span>
                        </button>
                    </div>
                    <div class="mt-3 text-center text-light opacity-75">
                        <small><i class="bi bi-keyboard me-1"></i>Или нажмите <kbd class="bg-light text-dark">1</kbd>-<kbd class="bg-light text-dark">5</kbd></small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include "../meta/footer.html" %}
</div>

<!-- Передача данных карточек в JavaScript -->
<script>
    window.flashcards = {{ cards_json|raw }};
</script>
<script src="/static/js/study.js"></script>
{% endblock %}
